# Miscellaneous Verifications

This document contains miscellaneous verification tests that don't fit into the other verification categories.

## Export and Context Verifications
```mermaid
graph LR;
  %% REQVIRE-AUTOGENERATED-DIAGRAM
  %% Graph styling
  classDef requirement fill:#f9d6d6,stroke:#f55f5f,stroke-width:1px;
  classDef verification fill:#d6f9d6,stroke:#5fd75f,stroke-width:1px;
  classDef externalLink fill:#d0e0ff,stroke:#3080ff,stroke-width:1px;
  classDef default fill:#f5f5f5,stroke:#333333,stroke-width:1px;

  735766802775ec41["Format Command Requirements Verification"];
  class 735766802775ec41 verification;
  click 735766802775ec41 "Misc.md#format-command-requirements-verification";
  eaf33ce1e6113c8a["test.sh"];
  class eaf33ce1e6113c8a default;
  click eaf33ce1e6113c8a "../../tests/test-advanced-format/test.sh";
  735766802775ec41 -->|satisfiedBy| eaf33ce1e6113c8a;
  14ef985b9a43174e["HTML Export Verification"];
  class 14ef985b9a43174e verification;
  click 14ef985b9a43174e "Misc.md#html-export-verification";
  8899a52ea9866d8b["test.sh"];
  class 8899a52ea9866d8b default;
  click 8899a52ea9866d8b "../../tests/test-html-export/test.sh";
  14ef985b9a43174e -->|satisfiedBy| 8899a52ea9866d8b;
  8903fde565a36e15["Model Formatting"];
  class 8903fde565a36e15 requirement;
  click 8903fde565a36e15 "../UserRequirements.md#model-formatting";
  47401bd64e231632["Parallel Linting Processing"];
  class 47401bd64e231632 requirement;
  click 47401bd64e231632 "../SystemRequirements/Requirements.md#parallel-linting-processing";
  8903fde565a36e15 -.->|deriveReqT| 47401bd64e231632;
  8dfe33c28555e80a["Replace Absolute Links with Relative Links"];
  class 8dfe33c28555e80a requirement;
  click 8dfe33c28555e80a "../UserRequirements.md#replace-absolute-links-with-relative-links";
  8903fde565a36e15 --o|contains| 8dfe33c28555e80a;
  b60a76b4bf328484["Formatting Command"];
  class b60a76b4bf328484 requirement;
  click b60a76b4bf328484 "../UserRequirements.md#formatting-command";
  8903fde565a36e15 --o|contains| b60a76b4bf328484;
  8903fde565a36e15 -.->|verifiedBy| 735766802775ec41;
  974ccf933675ef44["Format Consistency Enforcement"];
  class 974ccf933675ef44 requirement;
  click 974ccf933675ef44 "../UserRequirements.md#format-consistency-enforcement";
  8903fde565a36e15 --o|contains| 974ccf933675ef44;
  c9988cdcfdea77a["Formatting Output"];
  class c9988cdcfdea77a requirement;
  click c9988cdcfdea77a "../UserRequirements.md#formatting-output";
  b7dd9db7a1290b97["Git-Style Diff Output for Linting"];
  class b7dd9db7a1290b97 requirement;
  click b7dd9db7a1290b97 "../SystemRequirements/Requirements.md#git-style-diff-output-for-linting";
  c9988cdcfdea77a -.->|deriveReqT| b7dd9db7a1290b97;
  c9988cdcfdea77a -.->|verifiedBy| 735766802775ec41;
  a4c40962cac85d0c["Export HTML specifications"];
  class a4c40962cac85d0c requirement;
  click a4c40962cac85d0c "../UserRequirements.md#export-html-specifications";
  5deb63503bdf77c["HTML Export"];
  class 5deb63503bdf77c requirement;
  click 5deb63503bdf77c "../SystemRequirements/Requirements.md#html-export";
  a4c40962cac85d0c -.->|deriveReqT| 5deb63503bdf77c;
  a4c40962cac85d0c -.->|verifiedBy| 14ef985b9a43174e;
  974ccf933675ef44 -.->|verifiedBy| 735766802775ec41;
  9f473f6e0b993cac["Excess Whitespace Linting Implementation"];
  class 9f473f6e0b993cac requirement;
  click 9f473f6e0b993cac "../SystemRequirements/Requirements.md#excess-whitespace-linting-implementation";
  974ccf933675ef44 -.->|deriveReqT| 9f473f6e0b993cac;
  a7bd845c64d1685e["Reserved Subsections Linting Implementation"];
  class a7bd845c64d1685e requirement;
  click a7bd845c64d1685e "../SystemRequirements/Requirements.md#reserved-subsections-linting-implementation";
  974ccf933675ef44 -.->|deriveReqT| a7bd845c64d1685e;
  719bf8b75772947d["Missing Separators Linting Implementation"];
  class 719bf8b75772947d requirement;
  click 719bf8b75772947d "../SystemRequirements/Requirements.md#missing-separators-linting-implementation";
  974ccf933675ef44 -.->|deriveReqT| 719bf8b75772947d;
  7d44a9de72f2ed11["Incosistent Newlines Linting Implementation"];
  class 7d44a9de72f2ed11 requirement;
  click 7d44a9de72f2ed11 "../SystemRequirements/Requirements.md#incosistent-newlines-linting-implementation";
  974ccf933675ef44 -.->|deriveReqT| 7d44a9de72f2ed11;
  875f89a9f301fb90["Format Command"];
  class 875f89a9f301fb90 requirement;
  click 875f89a9f301fb90 "../SystemRequirements/Requirements.md#format-command";
  80defdd4cbc7ee18["cli.rs"];
  class 80defdd4cbc7ee18 default;
  click 80defdd4cbc7ee18 "../../cli/src/cli.rs";
  875f89a9f301fb90 -->|satisfiedBy| 80defdd4cbc7ee18;
  875f89a9f301fb90 -.->|verifiedBy| 735766802775ec41;
```
### HTML Export Verification

This test verifies that the system exports specifications into HTML format and saves them in the designated output location.

#### Details

##### Acceptance Criteria:
- System should export specifications to HTML format
- HTML files should be saved in the designated output location
- HTML output should maintain the structure and content of the original specifications
- SpecificationIndex.md should be renamed to index.html in output
- Links in diagrams and text must be converted to use .html instead of .md
- Paths in HTML files should maintain the original relative structure
- System should work in environments without Git repositories

##### Test Criteria:
- Command exits with success (0) return code
- HTML files are generated at the expected location with .html extension
- SpecificationIndex.md is converted to index.html
- HTML content preserves the structure and information from the source files
- Links in HTML files use .html extension instead of .md
- Mermaid click links are properly converted from .md to .html
- Both GitHub-style URLs and direct file paths in mermaid click links are handled correctly
- Paths should not have duplicated folder names (e.g., specifications/specifications)

#### Metadata
  * type: verification


#### Relations
  * verify: [Export HTML specifications](../UserRequirements.md#export-html-specifications)
  * satisfiedBy: [test.sh](../../tests/test-html-export/test.sh)

---

### Format Command Requirements Verification

This test verifies the format command requirements from SystemRequirements and UserRequirements, focusing on normalizing and standardizing MBSE models for consistency and readability.

#### Details

##### Acceptance Criteria

**Format Command Functionality:**
- System shall provide format command that normalizes and standardizes markdown documents
- System shall support --dry-run flag to preview changes without applying them
- System shall display changes in git diff style with line numbers and colors
- System shall preserve all document content while improving formatting consistency

**Content Preservation:**
- System shall preserve personas sections and other non-element content
- System shall maintain element ordering within sections
- System shall preserve section ordering throughout documents
- System shall preserve page content (frontmatter before first section)
- System shall preserve section content (content between section headers and first element)

**Formatting Consistency:**
- System shall trim excess whitespace from lines
- System shall normalize line endings consistently
- System shall insert proper separators between elements
- System shall normalize consecutive separators to single separators
- System shall normalize relation indentation to proper 2-space format
- System shall format relation links with human-readable names
- System shall clean up file references to show filename only for implementation files

**Change Preview Quality:**
- System shall show file identification clearly in change output
- System shall display line references with consistent width based on maximum line number
- System shall visualize trailing whitespace removal with special characters
- System shall use colors to distinguish additions (green) and removals (red)
- System shall group changes by file with clear separators
- System shall only show lines that have changes, omitting unchanged content
- System shall provide context lines before and after changes for better readability
- System shall maintain sequential line numbering that reflects final file positions
- System shall ensure line number continuity throughout diff output

**Relation Link Enhancement:**
- System shall convert simple identifiers (non-markdown format) to proper markdown link format
- System shall convert absolute links to relative links where appropriate
- System shall preserve already correct relative links without modification
- System shall replace fragment-only same-file references with full element names
- System shall convert implementation file paths to clean filename references
- System shall preserve external URLs without modification

##### Test Criteria

1. **Basic format functionality**
   - Format command runs successfully on test markdown files
   - Dry-run mode shows preview without making changes
   - Actual format command applies changes correctly

2. **Content preservation verification**
   - Personas sections remain intact after formatting
   - Element content and structure preserved
   - Section ordering maintained correctly
   - Page and section content preserved

3. **Change detection and preview**
   - Changes are clearly identified by file
   - Line references include consistent number width
   - Trailing whitespace removal is visualized
   - Color coding distinguishes addition/removal changes
   - Context lines provide readable context around changes
   - Line numbering maintains sequential continuity reflecting final file positions

4. **Relation link quality**
   - Simple identifiers are converted to proper markdown link format
   - Absolute links are converted to relative links where appropriate
   - Already correct relative links remain unchanged
   - Same-file references use human-readable element names
   - Implementation file references show clean filenames
   - Fragment references use proper notation

5. **Formatting consistency**
   - Excess whitespace is trimmed appropriately
   - Separators are inserted correctly between elements
   - Consecutive separators are normalized to single separators
   - Relation indentation is normalized to proper 2-space format
   - Line endings are normalized

6. **Line numbering accuracy**
   - Line numbers in diff output are sequential and consistent
   - Context lines maintain proper numbering continuity
   - Added lines show correct position in final file
   - Line numbering reflects final file structure accurately

#### Metadata
  * type: verification


#### Relations
  * verify: [Format Command](../SystemRequirements/Requirements.md#format-command)
  * verify: [Model Formatting](../UserRequirements.md#model-formatting)
  * verify: [Format Consistency Enforcement](../UserRequirements.md#format-consistency-enforcement)
  * verify: [Formatting Output](../UserRequirements.md#formatting-output)
  * satisfiedBy: [test.sh](../../tests/test-advanced-format/test.sh)

---