# Design Specification Document: Element Type and Metadata

This document describes the design and implementation of the element type and metadata system in ReqFlow.

### DSD_ElementTypeAndMetadata

## Overview

ReqFlow now supports a flexible approach to defining element types using metadata sections within elements rather than relying solely on filenames or folders. This allows for greater flexibility in organizing elements and enables users to explicitly define the type of each element.

## Element Types

### Supported Element Types

Element types are identified through a reserved "type" metadata property. The following types are supported:

1. **Requirement**: The default element type when no type is specified
2. **Verification**: For verification tests and validation procedures
3. **Other**: Custom element types defined by users

### Type Determination

The type of an element is determined through the following process:

1. If a `#### Metadata` section exists and includes a `type` property, use that value
2. If no type is specified, default to `Requirement`
3. Future versions may add more built-in types as needed

## Metadata Section

### Structure and Format

The metadata section of an element follows these rules:

1. Must be defined with a level 4 header: `#### Metadata`
2. Must be within an element (after a level 3 header)
3. Contains properties in list format: `* property_name: property_value`
4. May include any custom properties, not just `type`

### Reserved Properties

The following properties have special meaning:

- `type`: Defines the element type (requirement, verification, etc.)
- Additional reserved properties may be defined in future releases

### Example Metadata Section

```markdown
### My Element

This is a verification element.

#### Metadata
* type: verification
* priority: high
* owner: team-a

#### Relations
* verifies: [Some Requirement](#some-requirement)
```

## Implementation Details

### Element Registry

The Element struct now includes:

1. **element_type**: An `ElementType` enum value
2. **metadata**: A `HashMap<String, String>` of all metadata properties

### Metadata Parsing

When parsing elements from Markdown:

1. The parser identifies `#### Metadata` sections within elements
2. Properties are extracted from list items following the metadata header
3. The element type is set based on the metadata "type" property if present
4. All metadata is stored for potential future use

### Behavior Changes

With this implementation:

1. All markdown files are now processed for elements, regardless of filename
2. Elements can explicitly declare their type instead of relying on naming conventions
3. The same file can contain elements of different types
4. The design specifications folder remains handled specially due to its unique formatting
5. Files generated by ReqFlow itself (index.md, TraceabilityMatrix.md, generated-*.md) are excluded from processing to prevent circular references

## Future Extensions

The metadata system lays groundwork for potential future features:

1. Custom rendering based on element types
2. Filtering elements by metadata properties
3. Extended validation rules based on element types
4. Support for additional built-in element types

## References

This design implementation is related to several existing components:

- Element registry and management
- Markdown parsing
- Requirements and verification elements
- Traceability support